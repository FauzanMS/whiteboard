(this["webpackJsonpreact-fabricjs-whiteboard"]=this["webpackJsonpreact-fabricjs-whiteboard"]||[]).push([[0],{25:function(e,t,n){e.exports={whiteboard:"WhiteBoard_whiteboard__3PMpc",toolbar:"WhiteBoard_toolbar__3kTEu",dropdownButton:"WhiteBoard_dropdownButton__XgpWD",uploadDropdown:"WhiteBoard_uploadDropdown__1u8Bg",dropdownContent:"WhiteBoard_dropdownContent__oAziG"}},27:function(e,t,n){e.exports={pdfReader:"PdfReader_pdfReader__3P8qq",fileContainer:"PdfReader_fileContainer__2gJs-",pageInfo:"PdfReader_pageInfo__27lCr"}},41:function(e,t){},43:function(e,t,n){e.exports={app:"app_app__3mk8F"}},48:function(e,t,n){},53:function(e,t){},54:function(e,t){},55:function(e,t){},57:function(e,t){},58:function(e,t){},59:function(e,t){},60:function(e,t){},61:function(e,t){},64:function(e,t,n){"use strict";n.r(t);var r=n(1),o=n(42),c=n.n(o),i=n(36),a=n(23),u=n(15),s=n(16),l=n(39),d=n(38),f=n(27),b=n.n(f),j=n(4);d.a.GlobalWorkerOptions.workerSrc="//cdnjs.cloudflare.com/ajax/libs/pdf.js/".concat(d.a.version,"/pdf.worker.js");var p,g,h=function(e){var t=e.fileReaderInfo,n=e.updateFileReaderInfo;function r(e){n({currentPageNumber:t.currentPageNumber+e})}return Object(j.jsxs)("div",{className:b.a.pdfReader,children:[Object(j.jsx)("div",{className:b.a.fileContainer,children:Object(j.jsx)(l.a,{className:b.a.document,file:t.file,onLoadSuccess:function(e){var t=e.numPages;n({totalPages:t})},onLoadProgress:function(e){var t=e.loaded,n=e.total;return console.log("Loading a document: "+t/n*100+"%")},children:Object(j.jsx)(l.b,{className:"import-pdf-page",onRenderSuccess:function(){var e=document.querySelector(".import-pdf-page canvas").toDataURL();n({currentPage:e})},pageNumber:t.currentPageNumber})})}),Object(j.jsxs)("div",{className:b.a.pageInfo,children:[Object(j.jsxs)("span",{children:["Page ",t.currentPageNumber," of ",t.totalPages||"--"]}),Object(j.jsx)("button",{type:"button",disabled:t.currentPageNumber<=1,onClick:function(){return r(-1)},children:"Previous"}),Object(j.jsx)("button",{type:"button",disabled:t.currentPageNumber>=t.totalPages,onClick:function(){return r(1)},children:"Next"})]})]})},m=n(37),O=n.p+"static/media/remove.30a74efc.svg",v=function(e){return"eraser"===e.type?O:""},x=n.p+"static/media/select.ad97be73.svg",C=n.p+"static/media/eraser.6834b010.svg",w=n.p+"static/media/text.abecf614.svg",E=n.p+"static/media/rectangle.55957e34.svg",R=n.p+"static/media/line.8231e012.svg",y=n.p+"static/media/ellipse.8c29c164.svg",P=n.p+"static/media/triangle.58a0a70e.svg",k=n.p+"static/media/pencil.eda8d85b.svg",N=n.p+"static/media/delete.f634ca67.svg",A=n(25),I=n.n(A),L=null,M=!1,_={currentMode:"",currentColor:"#000000",currentWidth:5,fill:!1,group:{}},S={RECTANGLE:"RECTANGLE",TRIANGLE:"TRIANGLE",ELLIPSE:"ELLIPSE",LINE:"LINE",PENCIL:"PENCIL",ERASER:"ERASER"};function W(e){return function(t){_.currentMode===S.ERASER&&e.remove(t.target)}}function D(){M=!1}function B(e){e.off("mouse:down"),e.off("mouse:move"),e.off("mouse:up")}function T(e){S.currentMode!==S.LINE&&(_.currentMode=S.LINE,B(e),e.on("mouse:down",function(e){return function(t){var n=t.e;M=!0;var r=e.getPointer(n);L=new s.fabric.Line([r.x,r.y,r.x,r.y],{strokeWidth:_.currentWidth,stroke:_.currentColor,selectable:!1}),e.add(L),e.requestRenderAll()}}(e)),e.on("mouse:move",function(e){return function(t){var n=t.e;if(M){var r=e.getPointer(n);L.set({x2:r.x,y2:r.y}),L.setCoords(),e.requestRenderAll()}}}(e)),e.on("mouse:up",D),e.selection=!1,e.hoverCursor="auto",e.isDrawingMode=!1,e.getObjects().map((function(e){return e.set({selectable:!1})})),e.discardActiveObject().requestRenderAll())}function q(e){_.currentMode!==S.RECTANGLE&&(_.currentMode=S.RECTANGLE,B(e),e.on("mouse:down",function(e){return function(t){var n=t.e;M=!0;var r=e.getPointer(n);p=r.x,g=r.y,L=new s.fabric.Rect({stroke:_.currentColor,strokeWidth:_.currentWidth,fill:_.fill?_.currentColor:"transparent",left:p,top:g,width:0,height:0,selectable:!1}),e.add(L),L.on("mousedown",(function(t){_.currentMode===S.ERASER&&(console.log("\u522a\u9664",t),e.remove(t.target))}))}}(e)),e.on("mouse:move",function(e){return function(t){var n=t.e;if(M){var r=e.getPointer(n);r.x<p&&L.set("left",r.x),r.y<g&&L.set("top",r.y),L.set({width:Math.abs(r.x-p),height:Math.abs(r.y-g)}),L.setCoords(),e.renderAll()}}}(e)),e.on("mouse:up",D),e.selection=!1,e.hoverCursor="auto",e.isDrawingMode=!1,e.getObjects().map((function(e){return e.set({selectable:!1})})),e.discardActiveObject().requestRenderAll())}function G(e){_.currentMode!==S.ELLIPSE&&(_.currentMode=S.ELLIPSE,B(e),e.on("mouse:down",function(e){return function(t){var n=t.e;M=!0;var r=e.getPointer(n);p=r.x,g=r.y,L=new s.fabric.Ellipse({stroke:_.currentColor,strokeWidth:_.currentWidth,fill:_.fill?_.currentColor:"transparent",left:p,top:g,cornerSize:7,objectCaching:!1,selectable:!1}),e.add(L)}}(e)),e.on("mouse:move",function(e){return function(t){var n=t.e;if(M){var r=e.getPointer(n);r.x<p&&L.set("left",r.x),r.y<g&&L.set("top",r.y),L.set({rx:Math.abs(r.x-p)/2,ry:Math.abs(r.y-g)/2}),L.setCoords(),e.renderAll()}}}(e)),e.on("mouse:up",D),e.selection=!1,e.hoverCursor="auto",e.isDrawingMode=!1,e.getObjects().map((function(e){return e.set({selectable:!1})})),e.discardActiveObject().requestRenderAll())}function F(e){B(e),e.on("mouse:down",function(e){return function(t){var n=t.e;M=!0,_.currentMode=S.TRIANGLE;var r=e.getPointer(n);p=r.x,g=r.y,L=new s.fabric.Triangle({stroke:_.currentColor,strokeWidth:_.currentWidth,fill:_.fill?_.currentColor:"transparent",left:p,top:g,width:0,height:0,selectable:!1}),e.add(L)}}(e)),e.on("mouse:move",function(e){return function(t){var n=t.e;if(M){var r=e.getPointer(n);r.x<p&&L.set("left",r.x),r.y<g&&L.set("top",r.y),L.set({width:Math.abs(r.x-p),height:Math.abs(r.y-g)}),L.setCoords(),e.renderAll()}}}(e)),e.on("mouse:up",D),e.selection=!1,e.hoverCursor="auto",e.isDrawingMode=!1,e.getObjects().map((function(e){return e.set({selectable:!1})})),e.discardActiveObject().requestRenderAll()}var U=function(e){var t=e.aspectRatio,n=void 0===t?4/3:t,o=e.setFiles,c=Object(r.useState)(null),l=Object(u.a)(c,2),d=l[0],f=l[1],b=Object(r.useState)(5),p=Object(u.a)(b,2),g=p[0],O=p[1],A=Object(r.useState)(!1),L=Object(u.a)(A,2),M=L[0],D=L[1],U=Object(r.useState)({file:"",totalPages:null,currentPageNumber:1,currentPage:""}),z=Object(u.a)(U,2),H=z[0],J=z[1],X=Object(r.useRef)(null),V=Object(r.useRef)(null),Y=Object(r.useRef)(null),Z=Object(r.useRef)(null);Object(r.useEffect)((function(){if(!d&&X.current){var e=function(e,t){var n=new s.fabric.Canvas("canvas",{height:t,width:e});return s.fabric.Object.prototype.transparentCorners=!1,s.fabric.Object.prototype.cornerStyle="circle",s.fabric.Object.prototype.borderColor="#4447A9",s.fabric.Object.prototype.cornerColor="#4447A9",s.fabric.Object.prototype.cornerSize=6,s.fabric.Object.prototype.padding=10,s.fabric.Object.prototype.borderDashArray=[5,5],n.on("object:added",(function(e){e.target.on("mousedown",W(n))})),n.on("path:created",(function(e){e.path.on("mousedown",W(n))})),n}(V.current.clientWidth,V.current.clientWidth/n);f((function(){return e})),(t=function(e,t){return function(){var n=e.getWidth()/e.getHeight(),r=t.clientWidth,o=r/e.getWidth(),c=e.getZoom()*o;e.setDimensions({width:r,height:r/n}),e.setViewportTransform([c,0,0,c,0,0])}}(e,V.current),new ResizeObserver(t)).observe(V.current)}var t}),[X]),Object(r.useEffect)((function(){if(d){var e=d.getCenter();s.fabric.Image.fromURL(H.currentPage,(function(t){t.scaleToHeight(d.height),d.setBackgroundImage(t,d.renderAll.bind(d),{top:e.top,left:e.left,originX:"center",originY:"center"}),d.renderAll()}))}}),[H.currentPage]);var K=Object(r.useState)([]),Q=Object(u.a)(K,2),$=Q[0],ee=Q[1],te=Object(r.useState)(0),ne=Object(u.a)(te,2);ne[0],ne[1];function re(e){J(Object(i.a)(Object(i.a)({},H),e))}return Object(r.useEffect)((function(){console.log($)}),[$]),Object(j.jsxs)("div",{ref:V,className:I.a.whiteboard,children:[Object(j.jsxs)("div",{className:I.a.toolbar,children:[Object(j.jsx)("button",{type:"button",onClick:function(){return T(d)},children:Object(j.jsx)("img",{src:R,alt:"line"})}),Object(j.jsx)("button",{type:"button",onClick:function(){return q(d)},children:Object(j.jsx)("img",{src:E,alt:"Rectangle"})}),Object(j.jsx)("button",{type:"button",onClick:function(){return G(d)},children:Object(j.jsx)("img",{src:y,alt:"Ellipse"})}),Object(j.jsx)("button",{type:"button",onClick:function(){return F(d)},children:Object(j.jsx)("img",{src:P,alt:"Triangle"})}),Object(j.jsx)("button",{type:"button",onClick:function(){return function(e){_.currentMode!==S.PENCIL&&(B(e),_.currentMode=S.PENCIL,e.freeDrawingBrush.width=parseInt(_.currentWidth,10)||1,e.isDrawingMode=!0)}(d)},children:Object(j.jsx)("img",{src:k,alt:"Pencil"})}),Object(j.jsx)("button",{type:"button",onClick:function(){return function(e){B(e),e.isDrawingMode=!1;var t=new s.fabric.Textbox("text",{left:100,top:100,fill:_.currentColor,editable:!0});e.add(t),e.renderAll()}(d)},children:Object(j.jsx)("img",{src:w,alt:"Text"})}),Object(j.jsx)("button",{type:"button",onClick:function(){return function(e){_.currentMode="",e.isDrawingMode=!1,B(e),e.getObjects().map((function(e){return e.set({selectable:!0})})),e.hoverCursor="all-scroll"}(d)},children:Object(j.jsx)("img",{src:x,alt:"Selection mode"})}),Object(j.jsx)("button",{type:"button",onClick:function(){return function(e){_.currentMode!==S.ERASER&&(B(e),e.isDrawingMode=!1,_.currentMode=S.ERASER,e.hoverCursor="url(".concat(v({type:"eraser"}),"), default"))}(d)},children:Object(j.jsx)("img",{src:C,alt:"Eraser"})}),Object(j.jsx)("button",{type:"button",onClick:function(){return function(e){e.getObjects().forEach((function(t){t!==e.backgroundImage&&e.remove(t)}))}(d)},children:Object(j.jsx)("img",{src:N,alt:"Delete"})}),Object(j.jsxs)("div",{children:[Object(j.jsx)("input",{type:"checkbox",name:"fill",id:"fill",checked:M,onChange:function(e){_.fill=e.target.checked,D((function(){return e.target.checked}))}}),Object(j.jsx)("label",{htmlFor:"fill",children:"fill"})]}),Object(j.jsx)("input",{type:"range",min:1,max:20,step:1,value:g,onChange:function(e){var t=parseInt(e.target.value);_.currentWidth=t,d.freeDrawingBrush.width=t,O((function(){return t}))}}),Object(j.jsxs)("div",{className:I.a.uploadDropdown,children:[Object(j.jsx)("input",{ref:Y,accept:"image/*",type:"file",onChange:function(e){var t=new FileReader,n=e.target.files[0];t.addEventListener("load",(function(){s.fabric.Image.fromURL(t.result,(function(e){e.scaleToHeight(d.height),d.add(e)}))})),t.readAsDataURL(n)}}),Object(j.jsx)("input",{ref:Z,accept:".pdf",type:"file",onChange:function(e){re({file:e.target.files[0],currentPageNumber:1})}}),Object(j.jsx)("button",{className:I.a.dropdownButton,children:"+Upload"}),Object(j.jsxs)("div",{className:I.a.dropdownContent,children:[Object(j.jsx)("span",{onClick:function(){return Y.current.click()},children:"Image"}),Object(j.jsx)("span",{onClick:function(){return Z.current.click()},children:"PDF"})]})]}),Object(j.jsx)("button",{onClick:function(){X.current.toBlob((function(e){ee([].concat(Object(a.a)($),[e]));for(var t=0;t<$.length;t++)Object(m.saveAs)($[t],"image.png")})),Object(m.saveAs)(blob,"image.png"),d.getObjects().forEach((function(e){e!==d.backgroundImage&&d.remove(e)})),o($)},children:"Save as image"})]}),Object(j.jsx)("canvas",{ref:X,id:"canvas"}),Object(j.jsx)("div",{children:Object(j.jsx)("button",{onClick:function(){return function(e){X.current.toBlob((function(t){console.log(t,"blob"),ee([].concat(Object(a.a)($),[t])),e.getObjects().forEach((function(t){t!==e.backgroundImage&&e.remove(t)}))}))}(d)},children:"Next"})}),Object(j.jsx)("div",{children:H.length>0&&Object(j.jsx)(h,{fileReaderInfo:H,updateFileReaderInfo:re})})]})},z=n(43),H=n.n(z),J=function(){return Object(j.jsx)("div",{className:H.a.app,children:Object(j.jsx)("main",{children:Object(j.jsx)(U,{aspectRatio:4/3})})})};n(48);c.a.render(Object(j.jsx)(J,{}),document.getElementById("root"))}},[[64,1,2]]]);
//# sourceMappingURL=main.2f8250f6.chunk.js.map